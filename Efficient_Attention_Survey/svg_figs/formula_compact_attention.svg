<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 480">
  <defs>
    <linearGradient id="oGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f97316"/>
      <stop offset="100%" style="stop-color:#ea580c"/>
    </linearGradient>
    <filter id="sh3">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="480" fill="#0f172a"/>
  
  <!-- Main container -->
  <rect x="30" y="20" width="840" height="440" rx="16" fill="#1e293b" filter="url(#sh3)"/>
  
  <!-- Header -->
  <rect x="30" y="20" width="840" height="55" rx="16" fill="url(#oGrad)"/>
  <rect x="30" y="55" width="840" height="20" fill="url(#oGrad)"/>
  <text x="450" y="55" font-family="Arial, sans-serif" font-size="20" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Formula 3: Compact Attention (KV Cache Compression)
  </text>
  
  <!-- Info banner -->
  <rect x="50" y="95" width="800" height="35" rx="8" fill="#1e3a5f"/>
  <text x="450" y="115" font-family="Arial" font-size="13" fill="#f97316" text-anchor="middle" dominant-baseline="middle">
    Compress K,V → Kc, Vc (small), then Expand at inference time
  </text>
  
  <!-- Step 1 -->
  <rect x="50" y="145" width="800" height="80" rx="10" fill="#0f172a" stroke="#f97316" stroke-width="2"/>
  <text x="450" y="168" font-family="Arial" font-size="14" fill="#f97316" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Step 1: Project to Compressed Form
  </text>
  
  <text x="80" y="205" font-family="serif" font-size="22" fill="#f472b6" font-style="italic" dominant-baseline="middle">q</text>
  <text x="100" y="205" font-family="serif" font-size="22" fill="#64748b" dominant-baseline="middle">,</text>
  <text x="125" y="205" font-family="serif" font-size="22" fill="#fbbf24" font-style="italic" dominant-baseline="middle">Kc</text>
  <text x="160" y="205" font-family="serif" font-size="22" fill="#64748b" dominant-baseline="middle">,</text>
  <text x="185" y="205" font-family="serif" font-size="22" fill="#4ade80" font-style="italic" dominant-baseline="middle">Vc</text>
  <text x="225" y="205" font-family="serif" font-size="22" fill="#64748b" dominant-baseline="middle">=</text>
  <text x="265" y="205" font-family="Arial" font-size="16" fill="#a78bfa" dominant-baseline="middle">Proj</text>
  <text x="305" y="212" font-family="Arial" font-size="11" fill="#f472b6" dominant-baseline="middle">Q</text>
  <text x="320" y="205" font-family="serif" font-size="18" fill="#64748b" dominant-baseline="middle">(x),</text>
  <text x="370" y="205" font-family="Arial" font-size="16" fill="#a78bfa" dominant-baseline="middle">Proj</text>
  <text x="410" y="212" font-family="Arial" font-size="11" fill="#fbbf24" dominant-baseline="middle">Kc</text>
  <text x="430" y="205" font-family="serif" font-size="18" fill="#64748b" dominant-baseline="middle">(X),</text>
  <text x="480" y="205" font-family="Arial" font-size="16" fill="#a78bfa" dominant-baseline="middle">Proj</text>
  <text x="520" y="212" font-family="Arial" font-size="11" fill="#4ade80" dominant-baseline="middle">Vc</text>
  <text x="540" y="205" font-family="serif" font-size="18" fill="#64748b" dominant-baseline="middle">(X)</text>
  
  <!-- Step 2 -->
  <rect x="50" y="240" width="800" height="80" rx="10" fill="#0f172a" stroke="#f97316" stroke-width="2"/>
  <text x="450" y="263" font-family="Arial" font-size="14" fill="#f97316" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Step 2: Expand to Full Size
  </text>
  
  <text x="200" y="300" font-family="serif" font-size="26" fill="#fbbf24" font-style="italic" dominant-baseline="middle">K</text>
  <text x="230" y="300" font-family="serif" font-size="26" fill="#64748b" dominant-baseline="middle">,</text>
  <text x="260" y="300" font-family="serif" font-size="26" fill="#4ade80" font-style="italic" dominant-baseline="middle">V</text>
  <text x="300" y="300" font-family="serif" font-size="26" fill="#64748b" dominant-baseline="middle">=</text>
  <text x="360" y="300" font-family="Arial" font-size="16" fill="#22d3ee" dominant-baseline="middle">Expand</text>
  <text x="430" y="307" font-family="Arial" font-size="11" fill="#fbbf24" dominant-baseline="middle">K</text>
  <text x="445" y="300" font-family="serif" font-size="18" fill="#64748b" dominant-baseline="middle">(Kc),</text>
  <text x="510" y="300" font-family="Arial" font-size="16" fill="#22d3ee" dominant-baseline="middle">Expand</text>
  <text x="580" y="307" font-family="Arial" font-size="11" fill="#4ade80" dominant-baseline="middle">V</text>
  <text x="595" y="300" font-family="serif" font-size="18" fill="#64748b" dominant-baseline="middle">(Vc)</text>
  
  <!-- Step 3 -->
  <rect x="200" y="335" width="500" height="70" rx="10" fill="#0f172a" stroke="#f97316" stroke-width="2"/>
  <text x="450" y="358" font-family="Arial" font-size="14" fill="#f97316" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Step 3: Standard Multi-Head Attention
  </text>
  
  <text x="350" y="390" font-family="serif" font-size="30" fill="#f8fafc" font-style="italic" dominant-baseline="middle">o</text>
  <text x="385" y="390" font-family="serif" font-size="30" fill="#64748b" dominant-baseline="middle">=</text>
  <text x="430" y="390" font-family="Arial" font-size="20" fill="#a78bfa" dominant-baseline="middle">MHA</text>
  <text x="490" y="390" font-family="serif" font-size="24" fill="#64748b" dominant-baseline="middle">(</text>
  <text x="510" y="390" font-family="serif" font-size="24" fill="#f472b6" font-style="italic" dominant-baseline="middle">q</text>
  <text x="530" y="390" font-family="serif" font-size="24" fill="#64748b" dominant-baseline="middle">,</text>
  <text x="550" y="390" font-family="serif" font-size="24" fill="#fbbf24" font-style="italic" dominant-baseline="middle">K</text>
  <text x="575" y="390" font-family="serif" font-size="24" fill="#64748b" dominant-baseline="middle">,</text>
  <text x="595" y="390" font-family="serif" font-size="24" fill="#4ade80" font-style="italic" dominant-baseline="middle">V</text>
  <text x="620" y="390" font-family="serif" font-size="24" fill="#64748b" dominant-baseline="middle">)</text>
  
  <!-- Methods -->
  <rect x="50" y="420" width="800" height="35" rx="8" fill="#1e3a5f"/>
  <text x="100" y="440" font-family="Arial" font-size="12" fill="#f97316" dominant-baseline="middle">MQA: Repeat</text>
  <text x="250" y="440" font-family="Arial" font-size="12" fill="#f97316" dominant-baseline="middle">GQA: Group repeat</text>
  <text x="420" y="440" font-family="Arial" font-size="12" fill="#f97316" dominant-baseline="middle">MLA: Low-rank proj</text>
  <text x="600" y="440" font-family="Arial" font-size="12" fill="#4ade80" dominant-baseline="middle">Up to 8× memory savings!</text>
</svg>
