<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 750">
  <defs>
    <linearGradient id="hwGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#764ba2"/>
    </linearGradient>
    <linearGradient id="compactGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f093fb"/>
      <stop offset="100%" style="stop-color:#f5576c"/>
    </linearGradient>
    <linearGradient id="sparseGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe"/>
      <stop offset="100%" style="stop-color:#00f2fe"/>
    </linearGradient>
    <linearGradient id="linearGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#43e97b"/>
      <stop offset="100%" style="stop-color:#38f9d7"/>
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="750" fill="#0f172a"/>
  
  <!-- Title -->
  <text x="500" y="35" font-family="Arial, sans-serif" font-size="24" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Taxonomy of Efficient Attention Methods
  </text>
  
  <!-- Root node -->
  <rect x="400" y="55" width="200" height="40" rx="20" fill="#ef4444" filter="url(#shadow)"/>
  <text x="500" y="80" font-family="Arial" font-size="13" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Efficient Attention</text>
  
  <!-- Connecting lines -->
  <path d="M 500 95 L 500 120 L 125 120 L 125 145" stroke="#667eea" stroke-width="2" fill="none"/>
  <path d="M 500 95 L 500 120 L 375 120 L 375 145" stroke="#f093fb" stroke-width="2" fill="none"/>
  <path d="M 500 95 L 500 120 L 625 120 L 625 145" stroke="#4facfe" stroke-width="2" fill="none"/>
  <path d="M 500 95 L 500 120 L 875 120 L 875 145" stroke="#43e97b" stroke-width="2" fill="none"/>
  
  <!-- Class 1: Hardware-efficient -->
  <g transform="translate(20, 145)">
    <rect x="0" y="0" width="210" height="580" rx="12" fill="#1e293b" stroke="url(#hwGrad)" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="210" height="40" rx="12" fill="url(#hwGrad)"/>
    <rect x="0" y="25" width="210" height="15" fill="url(#hwGrad)"/>
    <text x="105" y="28" font-family="Arial" font-size="12" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Hardware-efficient</text>
    
    <text x="105" y="65" font-family="monospace" font-size="9" fill="#667eea" text-anchor="middle" dominant-baseline="middle">Same O(N²), optimized I/O</text>
    
    <!-- Prefilling -->
    <rect x="10" y="80" width="190" height="180" rx="8" fill="#0f172a"/>
    <text x="105" y="100" font-family="Arial" font-size="10" fill="#e2e8f0" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Prefilling Stage</text>
    <text x="20" y="122" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">FlashAttention</text>
    <text x="20" y="140" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">FlashAttention2</text>
    <text x="20" y="158" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">FlashAttention3</text>
    <text x="20" y="176" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">SageAttention</text>
    <text x="20" y="194" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">SageAttention2</text>
    <text x="20" y="212" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">SageAttention3</text>
    <text x="20" y="240" font-family="monospace" font-size="8" fill="#4ade80" dominant-baseline="middle">Ψ(·): Q,K preprocess</text>
    
    <!-- Decoding -->
    <rect x="10" y="270" width="190" height="140" rx="8" fill="#0f172a"/>
    <text x="105" y="290" font-family="Arial" font-size="10" fill="#e2e8f0" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Decoding Stage</text>
    <text x="20" y="312" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">FlashDecoding</text>
    <text x="20" y="330" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">KVQuant</text>
    <text x="20" y="348" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">KiVi</text>
    <text x="20" y="366" font-family="monospace" font-size="9" fill="#667eea" dominant-baseline="middle">PagedAttention</text>
    <text x="20" y="392" font-family="monospace" font-size="8" fill="#4ade80" dominant-baseline="middle">Θ(·): KV cache preprocess</text>
    
    <!-- Benefits -->
    <rect x="10" y="420" width="190" height="90" rx="8" fill="#1e3a5f"/>
    <text x="105" y="442" font-family="Arial" font-size="9" fill="#667eea" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Key Benefits</text>
    <text x="20" y="462" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ Exact attention</text>
    <text x="20" y="480" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ O(N) memory</text>
    <text x="20" y="498" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ 2-4× faster</text>
  </g>
  
  <!-- Class 2: Compact -->
  <g transform="translate(250, 145)">
    <rect x="0" y="0" width="210" height="580" rx="12" fill="#1e293b" stroke="url(#compactGrad2)" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="210" height="40" rx="12" fill="url(#compactGrad2)"/>
    <rect x="0" y="25" width="210" height="15" fill="url(#compactGrad2)"/>
    <text x="105" y="28" font-family="Arial" font-size="12" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Compact</text>
    
    <text x="105" y="65" font-family="monospace" font-size="9" fill="#f5576c" text-anchor="middle" dominant-baseline="middle">Compress KV cache</text>
    
    <!-- Methods -->
    <rect x="10" y="80" width="190" height="270" rx="8" fill="#0f172a"/>
    <text x="105" y="100" font-family="Arial" font-size="10" fill="#e2e8f0" text-anchor="middle" font-weight="bold" dominant-baseline="middle">KV Cache Compression</text>
    
    <text x="20" y="125" font-family="monospace" font-size="9" fill="#f5576c" dominant-baseline="middle">MHA (baseline)</text>
    <text x="170" y="125" font-family="monospace" font-size="8" fill="#64748b" text-anchor="end" dominant-baseline="middle">2hd</text>
    
    <text x="20" y="150" font-family="monospace" font-size="9" fill="#f5576c" dominant-baseline="middle">MQA</text>
    <text x="170" y="150" font-family="monospace" font-size="8" fill="#64748b" text-anchor="end" dominant-baseline="middle">2d (shared)</text>
    <text x="20" y="168" font-family="monospace" font-size="8" fill="#94a3b8" dominant-baseline="middle">All heads share 1 K,V</text>
    
    <text x="20" y="195" font-family="monospace" font-size="9" fill="#f5576c" dominant-baseline="middle">GQA</text>
    <text x="170" y="195" font-family="monospace" font-size="8" fill="#64748b" text-anchor="end" dominant-baseline="middle">2h_kv·d</text>
    <text x="20" y="213" font-family="monospace" font-size="8" fill="#94a3b8" dominant-baseline="middle">Groups share K,V (Llama2)</text>
    
    <text x="20" y="240" font-family="monospace" font-size="9" fill="#f5576c" dominant-baseline="middle">MLA</text>
    <text x="170" y="240" font-family="monospace" font-size="8" fill="#64748b" text-anchor="end" dominant-baseline="middle">r_kv+d_R</text>
    <text x="20" y="258" font-family="monospace" font-size="8" fill="#94a3b8" dominant-baseline="middle">Low-rank (DeepSeek-V2)</text>
    
    <text x="20" y="285" font-family="monospace" font-size="9" fill="#f5576c" dominant-baseline="middle">MFA</text>
    <text x="20" y="308" font-family="monospace" font-size="9" fill="#f5576c" dominant-baseline="middle">TPA</text>
    <text x="20" y="335" font-family="monospace" font-size="8" fill="#4ade80" dominant-baseline="middle">Expand: K,V from K_c,V_c</text>
    
    <!-- Benefits -->
    <rect x="10" y="360" width="190" height="150" rx="8" fill="#1e3a5f"/>
    <text x="105" y="382" font-family="Arial" font-size="9" fill="#f5576c" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Key Benefits</text>
    <text x="20" y="405" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ Reduced KV memory</text>
    <text x="20" y="425" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ Same quality (~)</text>
    <text x="20" y="445" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ Faster inference</text>
    <text x="20" y="475" font-family="monospace" font-size="8" fill="#94a3b8" dominant-baseline="middle">MQA: h× reduction</text>
    <text x="20" y="495" font-family="monospace" font-size="8" fill="#94a3b8" dominant-baseline="middle">GQA: h/g× reduction</text>
  </g>
  
  <!-- Class 3: Sparse -->
  <g transform="translate(480, 145)">
    <rect x="0" y="0" width="210" height="580" rx="12" fill="#1e293b" stroke="url(#sparseGrad3)" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="210" height="40" rx="12" fill="url(#sparseGrad3)"/>
    <rect x="0" y="25" width="210" height="15" fill="url(#sparseGrad3)"/>
    <text x="105" y="28" font-family="Arial" font-size="12" fill="#0f172a" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Sparse</text>
    
    <text x="105" y="65" font-family="monospace" font-size="9" fill="#4facfe" text-anchor="middle" dominant-baseline="middle">Skip zero attention</text>
    
    <!-- Static -->
    <rect x="10" y="80" width="190" height="130" rx="8" fill="#0f172a"/>
    <text x="105" y="100" font-family="Arial" font-size="10" fill="#e2e8f0" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Static Patterns</text>
    <text x="20" y="125" font-family="monospace" font-size="9" fill="#4facfe" dominant-baseline="middle">Local/Window</text>
    <text x="170" y="125" font-family="monospace" font-size="8" fill="#64748b" text-anchor="end" dominant-baseline="middle">O(Nw)</text>
    <text x="20" y="145" font-family="monospace" font-size="9" fill="#4facfe" dominant-baseline="middle">Longformer</text>
    <text x="20" y="165" font-family="monospace" font-size="9" fill="#4facfe" dominant-baseline="middle">BigBird</text>
    <text x="20" y="185" font-family="monospace" font-size="9" fill="#4facfe" dominant-baseline="middle">LongT5</text>
    
    <!-- Dynamic -->
    <rect x="10" y="220" width="190" height="130" rx="8" fill="#0f172a"/>
    <text x="105" y="240" font-family="Arial" font-size="10" fill="#e2e8f0" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Dynamic Selection</text>
    <text x="20" y="265" font-family="monospace" font-size="9" fill="#4facfe" dominant-baseline="middle">Reformer</text>
    <text x="170" y="265" font-family="monospace" font-size="8" fill="#64748b" text-anchor="end" dominant-baseline="middle">LSH</text>
    <text x="20" y="285" font-family="monospace" font-size="9" fill="#4facfe" dominant-baseline="middle">Routing Trans.</text>
    <text x="20" y="305" font-family="monospace" font-size="9" fill="#4facfe" dominant-baseline="middle">Clustered Attn</text>
    <text x="20" y="325" font-family="monospace" font-size="9" fill="#4facfe" dominant-baseline="middle">H2O</text>
    
    <!-- Benefits -->
    <rect x="10" y="360" width="190" height="150" rx="8" fill="#1e3a5f"/>
    <text x="105" y="382" font-family="Arial" font-size="9" fill="#4facfe" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Key Benefits</text>
    <text x="20" y="405" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ Sub-quadratic time</text>
    <text x="20" y="425" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ Very long sequences</text>
    <text x="20" y="445" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ Good for structured</text>
    <text x="20" y="480" font-family="monospace" font-size="8" fill="#94a3b8" dominant-baseline="middle">Complexity:</text>
    <text x="20" y="498" font-family="monospace" font-size="8" fill="#94a3b8" dominant-baseline="middle">O(N√N) or O(N log N)</text>
  </g>
  
  <!-- Class 4: Linear -->
  <g transform="translate(710, 145)">
    <rect x="0" y="0" width="270" height="580" rx="12" fill="#1e293b" stroke="url(#linearGrad3)" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="270" height="40" rx="12" fill="url(#linearGrad3)"/>
    <rect x="0" y="25" width="270" height="15" fill="url(#linearGrad3)"/>
    <text x="135" y="28" font-family="Arial" font-size="12" fill="#0f172a" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Linear</text>
    
    <text x="135" y="65" font-family="monospace" font-size="9" fill="#38f9d7" text-anchor="middle" dominant-baseline="middle">Kernel approx: φ(Q)φ(K)ᵀ</text>
    
    <!-- No gates -->
    <rect x="10" y="80" width="120" height="110" rx="8" fill="#0f172a"/>
    <text x="70" y="98" font-family="Arial" font-size="9" fill="#e2e8f0" text-anchor="middle" font-weight="bold" dominant-baseline="middle">No Gates</text>
    <text x="20" y="120" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">Linear Trans.</text>
    <text x="20" y="138" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">Performer</text>
    <text x="20" y="156" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">CHELA</text>
    <text x="20" y="174" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">SLAB</text>
    
    <!-- Forget gate -->
    <rect x="140" y="80" width="120" height="110" rx="8" fill="#0f172a"/>
    <text x="200" y="98" font-family="Arial" font-size="9" fill="#e2e8f0" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Forget Gate</text>
    <text x="150" y="120" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">RetNet</text>
    <text x="150" y="138" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">HGRN/HGRN2</text>
    <text x="150" y="156" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">GLA</text>
    <text x="150" y="174" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">Mamba, RWKV</text>
    
    <!-- Both gates -->
    <rect x="10" y="200" width="250" height="70" rx="8" fill="#0f172a"/>
    <text x="135" y="220" font-family="Arial" font-size="9" fill="#e2e8f0" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Forget + Select Gates</text>
    <text x="20" y="245" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">Mamba2</text>
    <text x="85" y="245" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">xLSTM</text>
    <text x="145" y="245" font-family="monospace" font-size="8" fill="#38f9d7" dominant-baseline="middle">DeltaNet</text>
    
    <!-- Forms -->
    <rect x="10" y="280" width="250" height="85" rx="8" fill="#0f172a"/>
    <text x="135" y="300" font-family="Arial" font-size="9" fill="#e2e8f0" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Computational Forms</text>
    <rect x="20" y="315" width="70" height="22" rx="4" fill="#667eea"/>
    <text x="55" y="328" font-family="monospace" font-size="8" fill="#fff" text-anchor="middle" dominant-baseline="middle">Parallel</text>
    <rect x="100" y="315" width="70" height="22" rx="4" fill="#f5576c"/>
    <text x="135" y="328" font-family="monospace" font-size="8" fill="#fff" text-anchor="middle" dominant-baseline="middle">Recurrent</text>
    <rect x="180" y="315" width="70" height="22" rx="4" fill="#4facfe"/>
    <text x="215" y="328" font-family="monospace" font-size="8" fill="#0f172a" text-anchor="middle" dominant-baseline="middle">Chunkwise</text>
    <text x="55" y="352" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle" dominant-baseline="middle">Training</text>
    <text x="135" y="352" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle" dominant-baseline="middle">Inference</text>
    <text x="215" y="352" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle" dominant-baseline="middle">Both</text>
    
    <!-- TTT -->
    <rect x="10" y="375" width="250" height="45" rx="8" fill="#0f172a" stroke="#f472b6" stroke-width="1"/>
    <text x="135" y="395" font-family="Arial" font-size="9" fill="#f472b6" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Test-Time Training</text>
    <text x="135" y="412" font-family="monospace" font-size="8" fill="#94a3b8" text-anchor="middle" dominant-baseline="middle">TTT-Linear, TTT-MLP (learnable H)</text>
    
    <!-- Benefits -->
    <rect x="10" y="430" width="250" height="80" rx="8" fill="#1e3a5f"/>
    <text x="135" y="452" font-family="Arial" font-size="9" fill="#38f9d7" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Key Benefits</text>
    <text x="20" y="475" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ O(Nd²) - Linear in N!</text>
    <text x="20" y="495" font-family="monospace" font-size="9" fill="#e2e8f0" dominant-baseline="middle">✓ Constant memory (recurrent)</text>
  </g>
</svg>
