<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 650">
  <defs>
    <linearGradient id="parallelGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#764ba2"/>
    </linearGradient>
    <linearGradient id="recurrentGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f093fb"/>
      <stop offset="100%" style="stop-color:#f5576c"/>
    </linearGradient>
    <linearGradient id="chunkGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe"/>
      <stop offset="100%" style="stop-color:#00f2fe"/>
    </linearGradient>
    <linearGradient id="qGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ff6b6b"/>
      <stop offset="100%" style="stop-color:#ee5a5a"/>
    </linearGradient>
    <linearGradient id="kGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ffd93d"/>
      <stop offset="100%" style="stop-color:#f4c430"/>
    </linearGradient>
    <linearGradient id="vGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4ade80"/>
      <stop offset="100%" style="stop-color:#22c55e"/>
    </linearGradient>
    <linearGradient id="hGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#38bdf8"/>
      <stop offset="100%" style="stop-color:#0ea5e9"/>
    </linearGradient>
    <linearGradient id="oGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#a78bfa"/>
      <stop offset="100%" style="stop-color:#8b5cf6"/>
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="2" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="650" fill="#0f172a"/>
  
  <!-- Title -->
  <text x="500" y="35" font-family="Arial, sans-serif" font-size="26" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Linear Attention: Three Computational Forms
  </text>
  <text x="500" y="65" font-family="monospace" font-size="12" fill="#64748b" text-anchor="middle" dominant-baseline="middle">
    O(Nd²) complexity via kernel approximation: softmax(QKᵀ) ≈ φ(Q)φ(K)ᵀ
  </text>
  
  <!-- Form 1: Parallel -->
  <g transform="translate(30, 95)">
    <rect x="0" y="0" width="300" height="240" rx="16" fill="#1e293b" stroke="url(#parallelGrad)" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="300" height="45" rx="16" fill="url(#parallelGrad)"/>
    <rect x="0" y="30" width="300" height="15" fill="url(#parallelGrad)"/>
    <text x="150" y="28" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Parallel Form</text>
    
    <text x="150" y="68" font-family="monospace" font-size="11" fill="#94a3b8" text-anchor="middle" dominant-baseline="middle">Best for: Training (GPU parallelism)</text>
    
    <!-- Step 1: H = K^T V -->
    <rect x="20" y="88" width="120" height="50" rx="8" fill="#0f172a"/>
    <rect x="30" y="98" width="35" height="30" rx="4" fill="url(#kGrad)"/>
    <text x="47" y="115" font-family="serif" font-size="13" fill="#1e293b" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Kᵀ</text>
    <text x="75" y="115" font-family="serif" font-size="14" fill="#94a3b8" dominant-baseline="middle">·</text>
    <rect x="90" y="98" width="35" height="30" rx="4" fill="url(#vGrad)"/>
    <text x="107" y="115" font-family="serif" font-size="13" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">V</text>
    
    <text x="155" y="115" font-family="Arial" font-size="16" fill="#667eea" dominant-baseline="middle">→</text>
    
    <rect x="175" y="98" width="50" height="30" rx="4" fill="url(#hGrad)"/>
    <text x="200" y="115" font-family="serif" font-size="13" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">H</text>
    <text x="235" y="115" font-family="monospace" font-size="9" fill="#64748b" dominant-baseline="middle">d×d</text>
    
    <!-- Step 2: O = Q H -->
    <rect x="20" y="148" width="260" height="50" rx="8" fill="#0f172a"/>
    <rect x="30" y="158" width="35" height="30" rx="4" fill="url(#qGrad)"/>
    <text x="47" y="175" font-family="serif" font-size="13" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Q</text>
    <text x="75" y="175" font-family="serif" font-size="14" fill="#94a3b8" dominant-baseline="middle">·</text>
    <rect x="90" y="158" width="35" height="30" rx="4" fill="url(#hGrad)"/>
    <text x="107" y="175" font-family="serif" font-size="13" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">H</text>
    
    <text x="145" y="175" font-family="Arial" font-size="16" fill="#667eea" dominant-baseline="middle">→</text>
    
    <rect x="165" y="158" width="50" height="30" rx="4" fill="url(#oGrad)"/>
    <text x="190" y="175" font-family="serif" font-size="13" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">O</text>
    <text x="225" y="175" font-family="monospace" font-size="9" fill="#64748b" dominant-baseline="middle">N×d</text>
    
    <text x="150" y="218" font-family="monospace" font-size="11" fill="#4ade80" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Time: O(Nd²) | Space: O(d²)</text>
  </g>
  
  <!-- Form 2: Recurrent -->
  <g transform="translate(350, 95)">
    <rect x="0" y="0" width="300" height="240" rx="16" fill="#1e293b" stroke="url(#recurrentGrad)" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="300" height="45" rx="16" fill="url(#recurrentGrad)"/>
    <rect x="0" y="30" width="300" height="15" fill="url(#recurrentGrad)"/>
    <text x="150" y="28" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Recurrent Form</text>
    
    <text x="150" y="68" font-family="monospace" font-size="11" fill="#94a3b8" text-anchor="middle" dominant-baseline="middle">Best for: Inference (constant memory)</text>
    
    <!-- State update: Ht = Ht-1 + kt^T vt -->
    <rect x="20" y="88" width="260" height="50" rx="8" fill="#0f172a"/>
    <text x="35" y="115" font-family="serif" font-size="13" fill="#38bdf8" font-style="italic" dominant-baseline="middle">Hₜ</text>
    <text x="60" y="115" font-family="serif" font-size="14" fill="#64748b" dominant-baseline="middle">=</text>
    <text x="85" y="115" font-family="serif" font-size="12" fill="#38bdf8" opacity="0.6" font-style="italic" dominant-baseline="middle">Hₜ₋₁</text>
    <text x="120" y="115" font-family="serif" font-size="14" fill="#64748b" dominant-baseline="middle">+</text>
    <rect x="140" y="100" width="30" height="25" rx="4" fill="url(#kGrad)"/>
    <text x="155" y="115" font-family="serif" font-size="11" fill="#1e293b" text-anchor="middle" font-weight="bold" dominant-baseline="middle">kₜᵀ</text>
    <text x="180" y="115" font-family="serif" font-size="14" fill="#94a3b8" dominant-baseline="middle">·</text>
    <rect x="195" y="100" width="30" height="25" rx="4" fill="url(#vGrad)"/>
    <text x="210" y="115" font-family="serif" font-size="11" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">vₜ</text>
    
    <!-- Output: ot = qt Ht -->
    <rect x="20" y="148" width="260" height="50" rx="8" fill="#0f172a"/>
    <text x="45" y="175" font-family="serif" font-size="13" fill="#a78bfa" font-style="italic" dominant-baseline="middle">oₜ</text>
    <text x="70" y="175" font-family="serif" font-size="14" fill="#64748b" dominant-baseline="middle">=</text>
    <rect x="90" y="160" width="30" height="25" rx="4" fill="url(#qGrad)"/>
    <text x="105" y="175" font-family="serif" font-size="11" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">qₜ</text>
    <text x="130" y="175" font-family="serif" font-size="14" fill="#94a3b8" dominant-baseline="middle">·</text>
    <rect x="150" y="160" width="35" height="25" rx="4" fill="url(#hGrad)"/>
    <text x="167" y="175" font-family="serif" font-size="11" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Hₜ</text>
    <text x="200" y="175" font-family="Arial" font-size="14" fill="#f5576c" dominant-baseline="middle">→</text>
    <rect x="220" y="160" width="40" height="25" rx="4" fill="url(#oGrad)"/>
    <text x="240" y="175" font-family="serif" font-size="11" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">oₜ</text>
    
    <text x="150" y="218" font-family="monospace" font-size="11" fill="#4ade80" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Time: O(d²)/step | Constant mem</text>
  </g>
  
  <!-- Form 3: Chunkwise -->
  <g transform="translate(670, 95)">
    <rect x="0" y="0" width="300" height="240" rx="16" fill="#1e293b" stroke="url(#chunkGrad)" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="300" height="45" rx="16" fill="url(#chunkGrad)"/>
    <rect x="0" y="30" width="300" height="15" fill="url(#chunkGrad)"/>
    <text x="150" y="28" font-family="Arial" font-size="16" fill="#0f172a" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Chunkwise Form</text>
    
    <text x="150" y="68" font-family="monospace" font-size="11" fill="#94a3b8" text-anchor="middle" dominant-baseline="middle">Best for: Both (optimal trade-off)</text>
    
    <!-- Chunk diagram -->
    <rect x="20" y="88" width="260" height="90" rx="8" fill="#0f172a"/>
    
    <!-- Previous state -->
    <rect x="30" y="115" width="40" height="30" rx="4" fill="url(#hGrad)" opacity="0.5"/>
    <text x="50" y="132" font-family="monospace" font-size="9" fill="#fff" text-anchor="middle" dominant-baseline="middle">H[i-1]</text>
    
    <text x="85" y="132" font-family="Arial" font-size="14" fill="#4facfe" dominant-baseline="middle">→</text>
    
    <!-- Chunk processing -->
    <rect x="100" y="100" width="120" height="60" rx="6" fill="#1e3a5f" stroke="#4facfe" stroke-width="1"/>
    <text x="160" y="118" font-family="monospace" font-size="9" fill="#4facfe" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Chunk [i]</text>
    <text x="125" y="145" font-family="monospace" font-size="9" fill="#a78bfa" dominant-baseline="middle">O[i]ⁱⁿᵗᵉʳ</text>
    <text x="165" y="145" font-family="Arial" font-size="12" fill="#64748b" dominant-baseline="middle">+</text>
    <text x="180" y="145" font-family="monospace" font-size="9" fill="#a78bfa" dominant-baseline="middle">O[i]ⁱⁿᵗʳᵃ</text>
    
    <text x="235" y="132" font-family="Arial" font-size="14" fill="#4facfe" dominant-baseline="middle">→</text>
    
    <!-- New state -->
    <rect x="250" y="115" width="35" height="30" rx="4" fill="url(#hGrad)"/>
    <text x="267" y="132" font-family="monospace" font-size="9" fill="#fff" text-anchor="middle" dominant-baseline="middle">H[i]</text>
    
    <!-- State update formula -->
    <rect x="20" y="190" width="260" height="30" rx="6" fill="#1e3a5f"/>
    <text x="150" y="207" font-family="monospace" font-size="10" fill="#4facfe" text-anchor="middle" dominant-baseline="middle">H[i] = H[i-1] + K[i]ᵀ · V[i]</text>
    
    <text x="150" y="255" font-family="monospace" font-size="11" fill="#4ade80" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Time: O(NC + Cd²)</text>
  </g>
  
  <!-- Comparison Table -->
  <rect x="30" y="360" width="940" height="260" rx="16" fill="#1e293b" stroke="#3b82f6" stroke-width="2" filter="url(#shadow)"/>
  <text x="500" y="395" font-family="Arial" font-size="18" fill="#fff" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Comparison: When to Use Each Form
  </text>
  
  <!-- Parallel column -->
  <rect x="50" y="420" width="280" height="175" rx="10" fill="#667eea" opacity="0.1"/>
  <text x="190" y="445" font-family="Arial" font-size="14" fill="#667eea" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Parallel Form</text>
  <text x="70" y="475" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ Full GPU utilization</text>
  <text x="70" y="500" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ Matrix-matrix operations</text>
  <text x="70" y="525" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ Best for training</text>
  <text x="70" y="555" font-family="monospace" font-size="11" fill="#ef4444" dominant-baseline="middle">✗ O(d²) memory for H</text>
  <text x="70" y="580" font-family="monospace" font-size="11" fill="#ef4444" dominant-baseline="middle">✗ Cannot stream tokens</text>
  
  <!-- Recurrent column -->
  <rect x="360" y="420" width="280" height="175" rx="10" fill="#f5576c" opacity="0.1"/>
  <text x="500" y="445" font-family="Arial" font-size="14" fill="#f5576c" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Recurrent Form</text>
  <text x="380" y="475" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ Constant memory</text>
  <text x="380" y="500" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ Stream tokens one-by-one</text>
  <text x="380" y="525" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ Best for inference</text>
  <text x="380" y="555" font-family="monospace" font-size="11" fill="#ef4444" dominant-baseline="middle">✗ Sequential (slow on GPU)</text>
  <text x="380" y="580" font-family="monospace" font-size="11" fill="#ef4444" dominant-baseline="middle">✗ No parallelism</text>
  
  <!-- Chunkwise column -->
  <rect x="670" y="420" width="280" height="175" rx="10" fill="#4facfe" opacity="0.1"/>
  <text x="810" y="445" font-family="Arial" font-size="14" fill="#4facfe" text-anchor="middle" font-weight="bold" dominant-baseline="middle">Chunkwise Form</text>
  <text x="690" y="475" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ Parallel within chunks</text>
  <text x="690" y="500" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ Recurrent between chunks</text>
  <text x="690" y="525" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ Best of both worlds</text>
  <text x="690" y="555" font-family="monospace" font-size="11" fill="#e2e8f0" dominant-baseline="middle">✓ FlashLinearAttention</text>
  <text x="690" y="580" font-family="monospace" font-size="11" fill="#94a3b8" dominant-baseline="middle">Chunk size C is tunable</text>
</svg>
