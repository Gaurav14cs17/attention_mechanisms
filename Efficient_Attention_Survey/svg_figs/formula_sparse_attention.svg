<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 420">
  <defs>
    <linearGradient id="spGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#4facfe"/>
      <stop offset="100%" style="stop-color:#00f2fe"/>
    </linearGradient>
    <filter id="sh4">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="420" fill="#0f172a"/>
  
  <!-- Main container -->
  <rect x="30" y="20" width="840" height="380" rx="16" fill="#1e293b" filter="url(#sh4)"/>
  
  <!-- Header -->
  <rect x="30" y="20" width="840" height="55" rx="16" fill="url(#spGrad)"/>
  <rect x="30" y="55" width="840" height="20" fill="url(#spGrad)"/>
  <text x="450" y="55" font-family="Arial, sans-serif" font-size="20" fill="#0f172a" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Formula 4: Sparse Attention (Skip Zero Computations)
  </text>
  
  <!-- Info banner -->
  <rect x="50" y="95" width="800" height="35" rx="8" fill="#1e3a5f"/>
  <text x="450" y="115" font-family="Arial" font-size="13" fill="#4facfe" text-anchor="middle" dominant-baseline="middle">
    Use attention mask M to skip computations where attention weight ≈ 0
  </text>
  
  <!-- Mask condition -->
  <rect x="50" y="145" width="800" height="90" rx="10" fill="#0f172a" stroke="#4facfe" stroke-width="2"/>
  <text x="450" y="170" font-family="Arial" font-size="14" fill="#4facfe" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Mask Condition
  </text>
  
  <text x="100" y="210" font-family="serif" font-size="22" fill="#f8fafc" font-style="italic" dominant-baseline="middle">M</text>
  <text x="125" y="217" font-family="serif" font-size="14" fill="#64748b" font-style="italic" dominant-baseline="middle">i,j</text>
  <text x="160" y="210" font-family="serif" font-size="22" fill="#64748b" dominant-baseline="middle">=</text>
  <text x="195" y="210" font-family="serif" font-size="22" fill="#ef4444" dominant-baseline="middle">−∞</text>
  <text x="260" y="210" font-family="Arial" font-size="16" fill="#94a3b8" dominant-baseline="middle">if block</text>
  <text x="340" y="210" font-family="serif" font-size="18" fill="#f8fafc" dominant-baseline="middle">[i × bq : (i+1) × bq][j × bkv : (j+1) × bkv]</text>
  <text x="690" y="210" font-family="serif" font-size="22" fill="#64748b" dominant-baseline="middle">=</text>
  <text x="730" y="210" font-family="serif" font-size="22" fill="#ef4444" dominant-baseline="middle">−∞</text>
  
  <!-- Skip condition -->
  <rect x="50" y="250" width="800" height="80" rx="10" fill="#0f172a" stroke="#4facfe" stroke-width="2"/>
  <text x="450" y="275" font-family="Arial" font-size="14" fill="#4facfe" text-anchor="middle" font-weight="bold" dominant-baseline="middle">
    Skip Condition
  </text>
  
  <text x="150" y="310" font-family="serif" font-size="22" fill="#f472b6" font-style="italic" dominant-baseline="middle">Q</text>
  <text x="175" y="318" font-family="serif" font-size="14" fill="#64748b" font-style="italic" dominant-baseline="middle">i</text>
  <text x="195" y="310" font-family="serif" font-size="22" fill="#fbbf24" font-style="italic" dominant-baseline="middle">K</text>
  <text x="225" y="295" font-family="serif" font-size="14" fill="#fbbf24" font-style="italic" dominant-baseline="middle">T</text>
  <text x="225" y="318" font-family="serif" font-size="14" fill="#64748b" font-style="italic" dominant-baseline="middle">j</text>
  <text x="260" y="310" font-family="serif" font-size="18" fill="#64748b" dominant-baseline="middle">,</text>
  <text x="310" y="310" font-family="serif" font-size="22" fill="#f8fafc" dominant-baseline="middle">P̃</text>
  <text x="340" y="318" font-family="serif" font-size="14" fill="#64748b" font-style="italic" dominant-baseline="middle">i,j</text>
  <text x="370" y="310" font-family="serif" font-size="22" fill="#4ade80" font-style="italic" dominant-baseline="middle">V</text>
  <text x="400" y="318" font-family="serif" font-size="14" fill="#64748b" font-style="italic" dominant-baseline="middle">j</text>
  <text x="450" y="310" font-family="Arial" font-size="16" fill="#94a3b8" dominant-baseline="middle">are</text>
  <text x="500" y="310" font-family="Arial" font-size="16" fill="#fbbf24" font-weight="bold" dominant-baseline="middle">skipped</text>
  <text x="580" y="310" font-family="Arial" font-size="16" fill="#94a3b8" dominant-baseline="middle">if</text>
  <text x="625" y="310" font-family="serif" font-size="22" fill="#f8fafc" font-style="italic" dominant-baseline="middle">M</text>
  <text x="655" y="318" font-family="serif" font-size="14" fill="#64748b" font-style="italic" dominant-baseline="middle">i,j</text>
  <text x="690" y="310" font-family="serif" font-size="22" fill="#64748b" dominant-baseline="middle">=</text>
  <text x="730" y="310" font-family="serif" font-size="22" fill="#ef4444" dominant-baseline="middle">−∞</text>
  
  <!-- Complexity -->
  <rect x="50" y="345" width="800" height="45" rx="8" fill="#1e3a5f"/>
  <text x="150" y="372" font-family="Arial" font-size="13" fill="#94a3b8" dominant-baseline="middle">Patterns:</text>
  <text x="240" y="372" font-family="Arial" font-size="12" fill="#4facfe" dominant-baseline="middle">Local (window)</text>
  <text x="380" y="372" font-family="Arial" font-size="12" fill="#4facfe" dominant-baseline="middle">Global + Local</text>
  <text x="530" y="372" font-family="Arial" font-size="12" fill="#4facfe" dominant-baseline="middle">LSH (Reformer)</text>
  <text x="680" y="372" font-family="Arial" font-size="12" fill="#4ade80" dominant-baseline="middle">O(N√N) or O(N log N)</text>
</svg>

