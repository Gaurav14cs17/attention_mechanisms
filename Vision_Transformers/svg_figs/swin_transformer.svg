<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 600">
  <defs>
    <linearGradient id="stage1Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#9b59b6"/>
      <stop offset="100%" style="stop-color:#8e44ad"/>
    </linearGradient>
    <linearGradient id="stage2Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3498db"/>
      <stop offset="100%" style="stop-color:#2980b9"/>
    </linearGradient>
    <linearGradient id="stage3Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#27ae60"/>
      <stop offset="100%" style="stop-color:#229954"/>
    </linearGradient>
    <linearGradient id="stage4Grad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e67e22"/>
      <stop offset="100%" style="stop-color:#d35400"/>
    </linearGradient>
  </defs>
  
  <!-- Title -->
  <text x="475" y="35" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Swin Transformer: Hierarchical Vision Transformer</text>
  
  <!-- Input Image -->
  <g>
    <rect x="30" y="120" width="80" height="80" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2"/>
    <text x="70" y="215" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Input</text>
    <text x="70" y="230" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">H x W x 3</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 115 160 L 145 160" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
  <defs>
    <marker id="arr" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#7f8c8d"/>
    </marker>
  </defs>
  
  <!-- Patch Partition -->
  <g>
    <rect x="150" y="110" width="90" height="100" rx="8" fill="#34495e"/>
    <text x="195" y="145" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="middle">Patch</text>
    <text x="195" y="162" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="middle">Partition</text>
    <text x="195" y="185" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.7)" text-anchor="middle" dominant-baseline="middle">4x4 patches</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 245 160 L 275 160" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
  
  <!-- Stage 1 -->
  <g>
    <rect x="280" y="70" width="130" height="180" rx="10" fill="url(#stage1Grad)"/>
    <text x="345" y="95" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="middle">Stage 1</text>
    <text x="345" y="115" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle" dominant-baseline="middle">H/4 x W/4</text>
    
    <rect x="295" y="130" width="100" height="30" rx="5" fill="white" opacity="0.95"/>
    <text x="345" y="150" font-family="Arial, sans-serif" font-size="10" fill="#8e44ad" text-anchor="middle" dominant-baseline="middle">Linear Embed</text>
    
    <rect x="295" y="168" width="100" height="35" rx="5" fill="white" opacity="0.95"/>
    <text x="345" y="182" font-family="Arial, sans-serif" font-size="9" fill="#8e44ad" text-anchor="middle" dominant-baseline="middle">Swin Block</text>
    <text x="345" y="195" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">x 2</text>
    
    <text x="345" y="230" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle" dominant-baseline="middle">C = 96</text>
  </g>
  
  <!-- Patch Merging Arrow -->
  <path d="M 415 160 L 445 160" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
  <text x="430" y="145" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">Patch</text>
  <text x="430" y="155" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">Merge</text>
  
  <!-- Stage 2 -->
  <g>
    <rect x="450" y="70" width="130" height="180" rx="10" fill="url(#stage2Grad)"/>
    <text x="515" y="95" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="middle">Stage 2</text>
    <text x="515" y="115" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle" dominant-baseline="middle">H/8 x W/8</text>
    
    <rect x="465" y="130" width="100" height="35" rx="5" fill="white" opacity="0.95"/>
    <text x="515" y="144" font-family="Arial, sans-serif" font-size="9" fill="#2980b9" text-anchor="middle" dominant-baseline="middle">Swin Block</text>
    <text x="515" y="157" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">x 2</text>
    
    <text x="515" y="230" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle" dominant-baseline="middle">C = 192</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 585 160 L 615 160" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
  
  <!-- Stage 3 -->
  <g>
    <rect x="620" y="70" width="130" height="180" rx="10" fill="url(#stage3Grad)"/>
    <text x="685" y="95" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="middle">Stage 3</text>
    <text x="685" y="115" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle" dominant-baseline="middle">H/16 x W/16</text>
    
    <rect x="635" y="130" width="100" height="35" rx="5" fill="white" opacity="0.95"/>
    <text x="685" y="144" font-family="Arial, sans-serif" font-size="9" fill="#229954" text-anchor="middle" dominant-baseline="middle">Swin Block</text>
    <text x="685" y="157" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">x 6</text>
    
    <text x="685" y="230" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle" dominant-baseline="middle">C = 384</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 755 160 L 785 160" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
  
  <!-- Stage 4 -->
  <g>
    <rect x="790" y="70" width="130" height="180" rx="10" fill="url(#stage4Grad)"/>
    <text x="855" y="95" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="middle">Stage 4</text>
    <text x="855" y="115" font-family="Arial, sans-serif" font-size="10" fill="rgba(255,255,255,0.8)" text-anchor="middle" dominant-baseline="middle">H/32 x W/32</text>
    
    <rect x="805" y="130" width="100" height="35" rx="5" fill="white" opacity="0.95"/>
    <text x="855" y="144" font-family="Arial, sans-serif" font-size="9" fill="#d35400" text-anchor="middle" dominant-baseline="middle">Swin Block</text>
    <text x="855" y="157" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">x 2</text>
    
    <text x="855" y="230" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle" dominant-baseline="middle">C = 768</text>
  </g>
  
  <!-- Swin Block Detail -->
  <g>
    <rect x="50" y="300" width="400" height="270" rx="10" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2"/>
    <text x="250" y="330" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Swin Transformer Block</text>
    
    <!-- Block 1 -->
    <rect x="70" y="355" width="170" height="190" rx="8" fill="#ecf0f1" stroke="#bdc3c7"/>
    <text x="155" y="375" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Block (even layer)</text>
    
    <rect x="85" y="395" width="140" height="28" rx="5" fill="#9b59b6"/>
    <text x="155" y="413" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" dominant-baseline="middle">W-MSA</text>
    
    <rect x="85" y="430" width="140" height="28" rx="5" fill="#e74c3c"/>
    <text x="155" y="448" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" dominant-baseline="middle">Window Attention</text>
    
    <rect x="85" y="470" width="140" height="28" rx="5" fill="#3498db"/>
    <text x="155" y="488" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" dominant-baseline="middle">MLP + LayerNorm</text>
    
    <text x="155" y="525" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">Regular windows</text>
    
    <!-- Block 2 -->
    <rect x="260" y="355" width="170" height="190" rx="8" fill="#ecf0f1" stroke="#bdc3c7"/>
    <text x="345" y="375" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Block (odd layer)</text>
    
    <rect x="275" y="395" width="140" height="28" rx="5" fill="#9b59b6"/>
    <text x="345" y="413" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" dominant-baseline="middle">SW-MSA</text>
    
    <rect x="275" y="430" width="140" height="28" rx="5" fill="#e67e22"/>
    <text x="345" y="448" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" dominant-baseline="middle">Shifted Window Attn</text>
    
    <rect x="275" y="470" width="140" height="28" rx="5" fill="#3498db"/>
    <text x="345" y="488" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" dominant-baseline="middle">MLP + LayerNorm</text>
    
    <text x="345" y="525" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">Shifted by M/2</text>
  </g>
  
  <!-- Window Attention Illustration -->
  <g>
    <rect x="500" y="300" width="400" height="270" rx="10" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2"/>
    <text x="700" y="330" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Window-based Self-Attention</text>
    
    <!-- Regular Windows -->
    <text x="600" y="360" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Regular Windows</text>
    <g>
      <rect x="530" y="375" width="60" height="60" fill="#e74c3c" opacity="0.3" stroke="#e74c3c" stroke-width="2"/>
      <rect x="595" y="375" width="60" height="60" fill="#3498db" opacity="0.3" stroke="#3498db" stroke-width="2"/>
      <rect x="530" y="440" width="60" height="60" fill="#27ae60" opacity="0.3" stroke="#27ae60" stroke-width="2"/>
      <rect x="595" y="440" width="60" height="60" fill="#f39c12" opacity="0.3" stroke="#f39c12" stroke-width="2"/>
    </g>
    
    <!-- Arrow -->
    <path d="M 680 440 L 720 440" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
    
    <!-- Shifted Windows -->
    <text x="800" y="360" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Shifted Windows</text>
    <g transform="translate(15, 15)">
      <rect x="715" y="375" width="60" height="60" fill="#e74c3c" opacity="0.3" stroke="#e74c3c" stroke-width="2"/>
      <rect x="780" y="375" width="60" height="60" fill="#3498db" opacity="0.3" stroke="#3498db" stroke-width="2"/>
      <rect x="715" y="440" width="60" height="60" fill="#27ae60" opacity="0.3" stroke="#27ae60" stroke-width="2"/>
      <rect x="780" y="440" width="60" height="60" fill="#f39c12" opacity="0.3" stroke="#f39c12" stroke-width="2"/>
    </g>
    <rect x="720" y="375" width="130" height="130" fill="none" stroke="#2c3e50" stroke-width="1" stroke-dasharray="5,3"/>
    
    <text x="700" y="540" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">Complexity: O(M^2 * N) instead of O(N^2) where M = window size</text>
  </g>
</svg>
