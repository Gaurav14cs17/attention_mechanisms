<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 400">
  <defs>
    <linearGradient id="imgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3498db"/>
      <stop offset="100%" style="stop-color:#2980b9"/>
    </linearGradient>
    <linearGradient id="patchGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e74c3c"/>
      <stop offset="100%" style="stop-color:#c0392b"/>
    </linearGradient>
    <linearGradient id="embedGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#27ae60"/>
      <stop offset="100%" style="stop-color:#229954"/>
    </linearGradient>
    <marker id="arr" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#7f8c8d"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="450" y="30" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Patch Embedding Process in ViT</text>
  
  <!-- Step 1: Input Image -->
  <g>
    <rect x="30" y="80" width="140" height="140" fill="url(#imgGrad)" rx="5"/>
    <text x="100" y="250" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Input Image</text>
    <text x="100" y="270" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">224 x 224 x 3</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 180 150 L 220 150" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
  
  <!-- Step 2: Split into patches -->
  <g>
    <rect x="230" y="60" width="160" height="180" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2" rx="5"/>
    <text x="310" y="85" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Split into Patches</text>
    
    <!-- Grid of patches -->
    <g transform="translate(250, 100)">
      <rect x="0" y="0" width="28" height="28" fill="#e74c3c" opacity="0.8"/>
      <rect x="32" y="0" width="28" height="28" fill="#3498db" opacity="0.8"/>
      <rect x="64" y="0" width="28" height="28" fill="#27ae60" opacity="0.8"/>
      <rect x="96" y="0" width="28" height="28" fill="#f39c12" opacity="0.8"/>
      <rect x="0" y="32" width="28" height="28" fill="#9b59b6" opacity="0.8"/>
      <rect x="32" y="32" width="28" height="28" fill="#1abc9c" opacity="0.8"/>
      <rect x="64" y="32" width="28" height="28" fill="#e67e22" opacity="0.8"/>
      <rect x="96" y="32" width="28" height="28" fill="#34495e" opacity="0.8"/>
      <rect x="0" y="64" width="28" height="28" fill="#16a085" opacity="0.8"/>
      <rect x="32" y="64" width="28" height="28" fill="#c0392b" opacity="0.8"/>
      <rect x="64" y="64" width="28" height="28" fill="#2980b9" opacity="0.8"/>
      <rect x="96" y="64" width="28" height="28" fill="#8e44ad" opacity="0.8"/>
    </g>
    
    <text x="310" y="225" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">14x14 = 196 patches</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 400 150 L 440 150" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
  
  <!-- Step 3: Flatten -->
  <g>
    <rect x="450" y="80" width="120" height="140" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2" rx="5"/>
    <text x="510" y="105" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Flatten</text>
    
    <rect x="465" y="120" width="90" height="18" fill="#e74c3c" opacity="0.8" rx="2"/>
    <rect x="465" y="142" width="90" height="18" fill="#3498db" opacity="0.8" rx="2"/>
    <rect x="465" y="164" width="90" height="18" fill="#27ae60" opacity="0.8" rx="2"/>
    <text x="510" y="195" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">...</text>
    
    <text x="510" y="215" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">16x16x3 = 768</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 580 150 L 620 150" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
  
  <!-- Step 4: Linear Projection -->
  <g>
    <rect x="630" y="60" width="130" height="180" fill="url(#embedGrad)" rx="8"/>
    <text x="695" y="90" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="middle">Linear Projection</text>
    <text x="695" y="110" font-family="Arial, sans-serif" font-size="11" fill="rgba(255,255,255,0.8)" text-anchor="middle" dominant-baseline="middle">E: 768 → D</text>
    
    <rect x="650" y="125" width="90" height="100" fill="white" opacity="0.9" rx="5"/>
    <text x="695" y="148" font-family="Arial, sans-serif" font-size="10" fill="#229954" text-anchor="middle" dominant-baseline="middle">[CLS]</text>
    <text x="695" y="165" font-family="Arial, sans-serif" font-size="10" fill="#229954" text-anchor="middle" dominant-baseline="middle">z₁</text>
    <text x="695" y="182" font-family="Arial, sans-serif" font-size="10" fill="#229954" text-anchor="middle" dominant-baseline="middle">z₂</text>
    <text x="695" y="199" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d" text-anchor="middle" dominant-baseline="middle">... z₁₉₆</text>
    
    <text x="695" y="225" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" dominant-baseline="middle">(N+1) x D</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 770 150 L 810 150" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arr)"/>
  
  <!-- Step 5: Add Position -->
  <g>
    <rect x="820" y="80" width="60" height="140" fill="#9b59b6" rx="5"/>
    <text x="850" y="120" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle" dominant-baseline="middle">+ Pos</text>
    <text x="850" y="140" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" dominant-baseline="middle">Embed</text>
    <text x="850" y="200" font-family="Arial, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)" text-anchor="middle" dominant-baseline="middle">E_pos</text>
  </g>
  
  <!-- Formula at bottom -->
  <rect x="100" y="300" width="700" height="70" fill="#f8f9fa" stroke="#dee2e6" rx="8"/>
  <text x="450" y="325" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">Patch Embedding Formula</text>
  <text x="450" y="350" font-family="monospace" font-size="13" fill="#2c3e50" text-anchor="middle" dominant-baseline="middle">z₀ = [x_class; x¹_p·E; x²_p·E; ...; xᴺ_p·E] + E_pos</text>
</svg>

